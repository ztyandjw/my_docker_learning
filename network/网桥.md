## 容器间的网络互通

创建namespace

ip netns add docker0
ip netns add docker1

查看创建出的namespace
ls -l /var/run/netns

创建veth pair
ip link add veth0 type veth peer name veth1
ip link add veth2 type veth peer name veth3

ip addr show

将veth的一端放入namespace中

ip link set veth0 netns docker0
ip link set veth2 netns docker1

进入docker0的namespace查看ip addr
ip netns exec docker0 ip addr show

ip netns exec docker1 ip addr show

此时宿主机的veth0 和 veth2已经消失

安装bridge网桥
install bridge-utils

brctl show

brctl addif br0 veth1
brctl addif br0 veth3

ip netns exec docker0 ip addr add 172.18.0.2/24 dev veth0
ip netns exec docker0 ip link set veth0 up

ip netns exec docker1 ip addr add 172.18.0.3/24 dev veth2
ip netns exec docker1 ip link set veth2 up

ip link set veth1 up
ip link set veth3 up

ip addr add 172.18.0.1/24 dev br0
ip link set br0 up

tcpdump -i br0 -n
ip netns exec docker0 ping -c 3 172.18.0.3





